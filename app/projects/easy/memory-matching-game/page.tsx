'use client';

/**
 * # Ð˜Ð³Ñ€Ð° "ÐÐ°Ð¹Ð´Ð¸ Ð¿Ð°Ñ€Ñƒ" (Memory Matching Game)
 *
 * ## ÐŸÑ€Ð¸Ð½Ñ†Ð¸Ð¿ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:
 *
 * 1. **Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸Ð³Ñ€Ñ‹**:
 *    - Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð½Ð°Ð±Ð¾Ñ€ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº, ÐºÐ°Ð¶Ð´Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð° Ð´Ð²Ð°Ð¶Ð´Ñ‹ Ð´Ð»Ñ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ð°Ñ€
 *    - ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÑˆÐ¸Ð²Ð°ÑŽÑ‚ÑÑ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ Ð¿Ñ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ Ð¸Ð³Ñ€Ñ‹
 *    - Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ…, ÑÐ¾Ð²Ð¿Ð°Ð²ÑˆÐ¸Ñ… ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº Ð¸ Ñ…Ð¾Ð´Ð¾Ð²
 *
 * 2. **Ð˜Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ**:
 *    - Ð˜Ð³Ñ€Ð¾Ðº Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸, Ð½Ð°Ð¶Ð¸Ð¼Ð°Ñ Ð½Ð° Ð½Ð¸Ñ…
 *    - Ð—Ð° Ð¾Ð´Ð¸Ð½ Ñ…Ð¾Ð´ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð´Ð²Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸
 *    - Ð•ÑÐ»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÑŽÑ‚, Ð¾Ð½Ð¸ Ð¾ÑÑ‚Ð°ÑŽÑ‚ÑÑ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¼Ð¸
 *    - Ð•ÑÐ»Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð½Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÑŽÑ‚, Ð¾Ð½Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°ÐºÑ€Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ðº Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
 *    - ÐšÐ°Ð¶Ð´Ð¾Ðµ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ ÐºÐ°Ðº Ð¾Ð´Ð¸Ð½ Ñ…Ð¾Ð´
 *
 * 3. **Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð¸Ð³Ñ€Ñ‹**:
 *    - Ð˜Ð³Ñ€Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ, ÐºÐ¾Ð³Ð´Ð° Ð²ÑÐµ Ð¿Ð°Ñ€Ñ‹ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹
 *    - ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ´ÐµÐ»Ð°Ð½Ð½Ñ‹Ñ… Ñ…Ð¾Ð´Ð¾Ð²
 *    - Ð˜Ð³Ñ€Ð¾Ðº Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð¸Ð³Ñ€Ñƒ, Ð½Ð°Ð¶Ð°Ð² ÐºÐ½Ð¾Ð¿ÐºÑƒ "Restart"
 *
 * 4. **ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸**:
 *    - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð¼ÐµÐ¼Ð¾Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð»Ð±ÑÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð»Ð¸ÑˆÐ½Ð¸Ñ… Ñ€ÐµÐ½Ð´ÐµÑ€Ð¾Ð²
 *    - Ð­Ñ„Ñ„ÐµÐºÑ‚Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ñ‹Ñ… Ñ†Ð¸ÐºÐ»Ð¾Ð²
 *    - Ð¢Ð°Ð¹Ð¼ÐµÑ€Ñ‹ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð¾Ñ‡Ð¸Ñ‰Ð°ÑŽÑ‚ÑÑ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ ÑƒÑ‚ÐµÑ‡ÐµÐº Ð¿Ð°Ð¼ÑÑ‚Ð¸
 *    - ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ð´Ð¾ÑÐºÐ¸ Ð¸ ÑÐºÑ€Ð°Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¼ÐµÐ¼Ð¾Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð´Ð»Ñ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ð½Ð³Ð°
 *
 * 5. **Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ**:
 *    - ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¸Ð¼ÐµÑŽÑ‚ Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ñ‹ ARIA Ð´Ð»Ñ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸
 *    - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ ÑÐµÐ¼Ð°Ð½Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€Ð¾Ð»Ð¸ Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²
 *    - Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð¾Ð¿Ð¸ÑÐ°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¼ÐµÑ‚ÐºÐ¸ Ð´Ð»Ñ ÑÐºÑ€Ð¸Ð½Ñ€Ð¸Ð´ÐµÑ€Ð¾Ð²
 *
 * @type {React.FC}
 * @returns {JSX.Element} ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¸Ð³Ñ€Ñ‹ "ÐÐ°Ð¹Ð´Ð¸ Ð¿Ð°Ñ€Ñƒ"
 */

import React, { JSX, useCallback, useEffect, useMemo, useState } from 'react';
import { Card } from '@/components/ui/card';
import _ from 'lodash';
import { Button } from '@/components/ui';

/**
 * @typedef {Object} CardItem
 * @property {number} id - Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸
 * @property {string} value - Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ (ÑÐ¼Ð¾Ð´Ð·Ð¸)
 */
type CardItem = {
  id: number;
  value: string;
}

/**
 * ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð½Ð°Ð±Ð¾Ñ€ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð»Ñ Ð¸Ð³Ñ€Ñ‹
 * @constant {CardItem[]}
 */
const INITIAL_CARDS: CardItem[] = [
  { id: 1, value: 'ðŸŽ' }, { id: 2, value: 'ðŸ' }, { id: 3, value: 'ðŸ‹' },
  { id: 4, value: 'ðŸ¥' }, { id: 5, value: 'ðŸ‡' }, { id: 6, value: 'ðŸ‰' },
];

/**
 * ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¸Ð³Ñ€Ñ‹ "ÐÐ°Ð¹Ð´Ð¸ Ð¿Ð°Ñ€Ñƒ"
 *
 * @description
 * ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¸Ð³Ñ€Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼ Ð¸Ð³Ñ€Ñ‹,
 * Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ Ð¸Ð³Ñ€Ð¾Ð²ÑƒÑŽ Ð´Ð¾ÑÐºÑƒ.
 *
 * @returns {JSX.Element} ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¸Ð³Ñ€Ñ‹
 */
const MemoryMatchingPage = (): JSX.Element => {
  // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ useMemo Ð´Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐ¼ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ñ ÐºÐ°Ñ€Ñ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐ¼ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¸ Ñ€ÐµÑ€ÐµÐ½Ð´ÐµÑ€Ð°Ñ…
  const initialCards = useMemo(() => _.shuffle([...INITIAL_CARDS, ...INITIAL_CARDS]), []);
  const [cards, setCards] = useState<CardItem[]>(initialCards);
  const [opened, setOpened] = useState<number[]>([]);
  const [matched, setMatched] = useState<number[]>([]);
  const [moves, setMoves] = useState<number>(0);
  const [endGame, setEndGame] = useState<boolean>(false);

  /**
   * ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ²Ð¾Ñ€Ð¾Ñ‚ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸
   *
   * @param {number} idx - Ð˜Ð½Ð´ÐµÐºÑ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð² Ð¼Ð°ÑÑÐ¸Ð²Ðµ
   * @returns {void}
   */
  const flipCard = useCallback((idx: number) => {
    // ÐŸÑ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÑƒÐ¶Ðµ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… ÐºÐ°Ñ€Ñ‚ Ð¸Ð»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð±Ð¾Ð»ÐµÐµ 2 ÐºÐ°Ñ€Ñ‚ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾
    if (opened.includes(idx) || opened.length === 2) return;

    setMoves(prevMoves => prevMoves + 1);
    setOpened(prevOpened => [...prevOpened, idx]);
  }, [opened]);

  /**
   * ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð¸Ð³Ñ€Ñƒ, ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°Ñ Ð²ÑÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
   *
   * @returns {void}
   */
  const handleRestart = useCallback(() => {
    setCards(_.shuffle([...INITIAL_CARDS, ...INITIAL_CARDS]));
    setOpened([]);
    setMatched([]);
    setMoves(0);
    setEndGame(false);
  }, []);

  /**
   * Ð­Ñ„Ñ„ÐµÐºÑ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº
   *
   * @description
   * ÐšÐ¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹ Ð´Ð²Ðµ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¸Ñ… Ð½Ð° ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ.
   * Ð•ÑÐ»Ð¸ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÑŽÑ‚, Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð¸Ñ… Ð² ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ¾Ð²Ð¿Ð°Ð²ÑˆÐ¸Ñ….
   * Ð’ Ð»ÑŽÐ±Ð¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ, Ð·Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· 800Ð¼Ñ.
   */
  useEffect(() => {
    if (opened.length !== 2) return;

    const [firstCard, secondCard] = opened.map(idx => cards[idx]);

    if (firstCard.value === secondCard.value) {
      setMatched(prevMatched => [...prevMatched, firstCard.id]);
    }

    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÑƒÑŽ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÑƒ
    const timer = setTimeout(() => setOpened([]), 800);
    return () => clearTimeout(timer);
  }, [opened, cards]);

  /**
   * Ð­Ñ„Ñ„ÐµÐºÑ‚ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¸Ð³Ñ€Ñ‹
   *
   * @description
   * ÐšÐ¾Ð³Ð´Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð²ÑˆÐ¸Ñ… ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº Ñ€Ð°Ð²Ð½Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ
   * ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐµÐº, Ð¸Ð³Ñ€Ð° ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ð¾Ð¹.
   */
  useEffect(() => {
    if (matched.length === INITIAL_CARDS.length) setEndGame(true);
  }, [matched]);

  /**
   * ÐœÐµÐ¼Ð¾Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ð¸Ð³Ñ€Ð¾Ð²Ð¾Ð¹ Ð´Ð¾ÑÐºÐ¸
   *
   * @type {JSX.Element}
   */
  const gameBoard = useMemo(() => (
    <div className="grid grid-cols-4 gap-2 sm:gap-4 w-full">
      {cards.map((item, idx) => (
        <div
          key={idx}
          className={`card ${opened.includes(idx) || matched.includes(item.id) ? 'flipped' : ''}`}
          onClick={() => flipCard(idx)}
          role="button"
          aria-label={`Card ${idx + 1}, ${opened.includes(idx) || matched.includes(item.id) ? 'flipped' : 'hidden'}`}
        >
          <div className="inner">
            <div className="front">{item.value}</div>
            <div className="back">?</div>
          </div>
        </div>
      ))}
    </div>
  ), [cards, opened, matched, flipCard]);

  /**
   * ÐœÐµÐ¼Ð¾Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ ÑÐºÑ€Ð°Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¸Ð³Ñ€Ñ‹
   *
   * @type {JSX.Element}
   */
  const endGameScreen = useMemo(() => (
    <div className="grid gap-2 text-center max-w-xl mx-auto">
      <p className="text-2xl font-semibold">You win âœ¨</p>
      <p className="text-lg">
        You completed the game in <span className="font-semibold">{moves}</span> steps
      </p>
      <Button onClick={handleRestart}>Restart</Button>
    </div>
  ), [moves, handleRestart]);

  return (
    <Card className="max-w-3xl w-full mx-auto p-4 rounded">
      {endGame ? endGameScreen : gameBoard}
    </Card>
  );
};

export default MemoryMatchingPage;