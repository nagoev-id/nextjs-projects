'use client';

/**
 * # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏
 *
 * ## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:
 *
 * 1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤**:
 *    - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç React —Å —Ö—É–∫–∞–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–µ–π –¥—ã—Ö–∞–Ω–∏—è
 *    - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –¥—ã—Ö–∞–Ω–∏—è (7.5 —Å–µ–∫—É–Ω–¥):
 *      - –í–¥–æ—Ö: 3 —Å–µ–∫—É–Ω–¥—ã (2/5 –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
 *      - –ó–∞–¥–µ—Ä–∂–∫–∞: 1.5 —Å–µ–∫—É–Ω–¥—ã (1/5 –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
 *      - –í—ã–¥–æ—Ö: 3 —Å–µ–∫—É–Ω–¥—ã (–æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è)
 *    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è useRef –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
 *
 * 2. **–¶–∏–∫–ª –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏**:
 *    - –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
 *    - –ö–∞–∂–¥—ã–π —Ü–∏–∫–ª —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–∑:
 *      1. –§–∞–∑–∞ –≤–¥–æ—Ö–∞: –∫—Ä—É–≥ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, —Ç–µ–∫—Å—Ç "Breathe In! üò§"
 *      2. –§–∞–∑–∞ –∑–∞–¥–µ—Ä–∂–∫–∏: —Ä–∞–∑–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, —Ç–µ–∫—Å—Ç –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "Hold ü§ê"
 *      3. –§–∞–∑–∞ –≤—ã–¥–æ—Ö–∞: –∫—Ä—É–≥ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è, —Ç–µ–∫—Å—Ç –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "Breathe Out! üòÆ‚Äçüí®"
 *    - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞ –∞–Ω–∏–º–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è
 *
 * 3. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:
 *    - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ –º–µ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–∞–∑–æ–π –¥—ã—Ö–∞–Ω–∏—è
 *    - –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä–µ –∫—Ä—É–≥–∞ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 *    - –ê–Ω–∏–º–∞—Ü–∏—è –ø–ª–∞–≤–Ω–∞—è –±–ª–∞–≥–æ–¥–∞—Ä—è CSS-–ø–µ—Ä–µ—Ö–æ–¥–∞–º (–∫–ª–∞—Å—Å—ã 'grow' –∏ 'shrink')
 *    - –î–∏–∑–∞–π–Ω –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–ª—è –ª—É—á—à–µ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏
 *
 * 4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏**:
 *    - –ü—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã –æ—á–∏—â–∞—é—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
 *    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è useEffect —Å –ø—É—Å—Ç—ã–º –º–∞—Å—Å–∏–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
 *
 * 5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**:
 *    - –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
 *    - –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
 *    - –≠–º–æ–¥–∑–∏ –¥–æ–±–∞–≤–ª—è—é—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫ –∫–∞–∂–¥–æ–π —Ñ–∞–∑–µ –¥—ã—Ö–∞–Ω–∏—è
 *    - –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—Ç —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—é
 */

import { Card } from '@/components/ui/card';
import { JSX, useEffect, useRef, useState } from 'react';

/**
 * –¢–∏–ø –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
 * @typedef {Object} DefaultValues
 * @property {number} total - –û–±—â–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∞ –¥—ã—Ö–∞–Ω–∏—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
 * @property {number} breathe - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑—ã –≤–¥–æ—Ö–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
 * @property {number} hold - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –¥—ã—Ö–∞–Ω–∏—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
 */
type DefaultValues = {
  total: number;
  breathe: number;
  hold: number;
}

/**
 * –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –¥–ª—è –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–µ—Ç—Ç–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ñ–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
 *
 * @constant {DefaultValues}
 */
const DEFAULT_VALUES: DefaultValues = {
  /** –û–±—â–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∞ –¥—ã—Ö–∞–Ω–∏—è (7.5 —Å–µ–∫—É–Ω–¥) */
  total: 7500,

  /**
   * –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑—ã –≤–¥–æ—Ö–∞ (2/5 –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
   * @returns {number} –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
   */
  get breathe() {
    return (this.total / 5) * 2;
  },

  /**
   * –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –¥—ã—Ö–∞–Ω–∏—è (1/5 –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
   * @returns {number} –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
   */
  get hold() {
    return this.total / 5;
  },
};

/**
 * –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏
 * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫—Ä—É–≥ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—ã—Ö–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 *
 * @returns {JSX.Element} –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏
 */
const BreathingRelaxationPage = (): JSX.Element => {
  /**
   * –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑—ã –¥—ã—Ö–∞–Ω–∏—è
   * @type {[string, React.Dispatch<React.SetStateAction<string>>]}
   */
  const [text, setText] = useState<string>('');

  /**
   * –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è CSS-–∫–ª–∞—Å—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –∞–Ω–∏–º–∞—Ü–∏–µ–π
   * @type {[string, React.Dispatch<React.SetStateAction<string>>]}
   */
  const [containerClass, setContainerClass] = useState<string>('');

  /**
   * –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
   * @type {React.MutableRefObject<NodeJS.Timeout | null>}
   */
  const intervalRef = useRef<NodeJS.Timeout | null>(null);

  /**
   * –ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–¥–∏–Ω —Ü–∏–∫–ª –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
   * –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ñ–∞–∑—ã –≤–¥–æ—Ö–∞, –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ –≤—ã–¥–æ—Ö–∞
   */
  const startBreathingAnimation = (): void => {
    // –§–∞–∑–∞ –≤–¥–æ—Ö–∞
    setText('Breathe In! üò§');
    setContainerClass('grow');

    // –§–∞–∑–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥—ã—Ö–∞–Ω–∏—è (–ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –≤—Ä–µ–º—è –≤–¥–æ—Ö–∞)
    setTimeout(() => {
      setText('Hold ü§ê');

      // –§–∞–∑–∞ –≤—ã–¥–æ—Ö–∞ (–ø–æ—Å–ª–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è)
      setTimeout(() => {
        setText('Breathe Out! üòÆ‚Äçüí®');
        setContainerClass('shrink');
      }, DEFAULT_VALUES.hold);
    }, DEFAULT_VALUES.breathe);
  };

  /**
   * –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–∏–∫–ª–æ–º –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
   * –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   */
  useEffect(() => {
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—ã–π —Ü–∏–∫–ª –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
    startBreathingAnimation();

    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
    intervalRef.current = setInterval(startBreathingAnimation, DEFAULT_VALUES.total);

    // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    return () => {
      if (intervalRef.current) {
        clearInterval(intervalRef.current);
      }
    };
  }, []);

  return (
    <Card className="max-w-4xl bg-transparent shadow-none w-full mx-auto p-4 pt-15 rounded border-none">
      <div className="grid font-semibold">
        <div className="grid place-items-center">
          {/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –¥—ã—Ö–∞–Ω–∏—è, –∫–ª–∞—Å—Å –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∞–∑—ã */}
          <div className={`${containerClass} flex items-center justify-center h-[300px] w-[300px] relative scale-100`}>
            {/* –§–æ–Ω–æ–≤—ã–π –∫—Ä—É–≥ */}
            <div className="bg-white dark:bg-accent h-full w-full rounded-full absolute top-0 left-0 -z-[1]" />
            {/* –¢–µ–∫—Å—Ç–æ–≤–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑—ã –¥—ã—Ö–∞–Ω–∏—è */}
            <p>{text}</p>
            {/* –£–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–∫—Ü–µ–Ω—Ç–∞ */}
            <div className="pointer">
              <span className="bg-[#F78D3F] border-4 border-solid h-5 w-5 block rounded-full" />
            </div>
            {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫—Ä—É–≥ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ */}
            <div className="circle" />
          </div>
        </div>
      </div>
    </Card>
  );
};

export default BreathingRelaxationPage;